---
# NOTE: We need this running before slurmdbd
- name: Restart Munge service
  service:
    name: "munge"
    state: restarted

# NOTE: we need this running before slurmd
# Allows you to reconfigure slurmctld from another host
- name: Issue slurmctld restart command
  service:
    name: "slurmctld"
    state: restarted
  run_once: true
  listen: Restart slurmctld service

- name: Check slurmctld actually restarted
  wait_for:
    port: 6817
    delay: 10
  run_once: true
  listen: Restart slurmctld service

- name: Restart slurmd service
  service:
    name: "slurmd"
    state: restarted